<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" media="screen" href="demo.css" type="text/css" />
    <title>Image formats comparison</title>
    <script async src="js/bpgdec-0.9.4.js"></script>
    <script async src="js/pica.min.js"></script>
    <script async src="js/splitimage2.js"></script>
</head>

<body style="max-width: 100%;">

    <div class="demo" style="margin-left: auto; margin-right: auto; overflow:hidden;">
        <table>
            <tr>
                <td class="title" colspan=3>
                    <select id="subsetSel" style="font-size: 1.1em; margin-bottom: 1em;">
                    </select>
                </td>
            </tr>
            <tr>
                <td class="title" colspan=3>
                    <select id="fileSel" style="font-size: 1.1em; margin-bottom: 1em;" multiple="multiple">
                    </select>
                </td>
            </tr>
            <tr>
                <td class="title" style="width:16em;padding-left:4em;text-align:right;">
                    <select id="leftSel" style="font-size: 1.1em;">
                    </select>
                    <select id="leftQual" style="font-size: 1.1em;">
                        <option value="ll">Lossless</option>
                        <option value="l">Large</option>
                        <option value="m">Medium</option>
                        <option value="s" selected>Small</option>
                        <option value="t">Tiny</option>
                    </select>
                </td>
                <td class="center-head" id="center-head">
                    --- vs ---
                </td>
                <td class="title" style="width:16em;padding-right:4em;text-align:left;">
                    <select id="rightSel" style="font-size: 1.1em;">
                    </select>
                    <select id="rightQual" style="font-size: 1.1em;">
                        <option value="ll">Lossless</option>
                        <option value="l">Large</option>
                        <option value="m">Medium</option>
                        <option value="s" selected>Small</option>
                        <option value="t">Tiny</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td colspan=3 style="padding-top: 1em; padding-bottom: 1em;">
                    <div id="rightContainer" style="margin-left: auto; margin-right: auto; position: relative; width:800px; height:800px;">
                        <div id="leftContainer" style="border-right: 1px dotted white; width:800px; height:800px;"></div>
                        <div id="leftText" style="position: absolute; color: white; padding:.2em .5em .2em .5em;"></div>
                        <div id="rightText" style="position: absolute; color: white; padding:.2em .5em .2em .5em;"></div>
                    </div>
                </td>
            </tr>
            <tr>
                <td class="title" colspan="3" style="width: 20%; text-align: center; padding-bottom: 1.25em;">
                    <select id="scaleSel" style="width:5em ;font-size: 1em;text-align:center;">
                        <option ratio="1:3" value="0.5773502692">1/3</option>
                        <option ratio="1:2" value="0.7071067812">1/2</option>
                        <option ratio="1:1" value="1" selected>---</option>
                        <option ratio="2:1" value="1.414213562">2x</option>
                        <option ratio="3:1" value="1.732050808">3x</option>
                    </select>
                </td>
            </tr>
        </table>
    </div>
    <div class="caption">
        <h1>image-formats-comparision</h1>
        <h2>Speed and lossy compression metrics</h2>
        <ul>
        <li><a href="speed_results.html" target="_blank">Compression ratio and speed</a></li>
        <li><a href="lossy_results.html" target="_blank">Lossy compression comparison</a></li>
        </ul>
        <h2>Evolution of the AV1 codec</h2>
        <ul>
        <li><a href="comparison.html" target="_blank">Comparison between October 2016 and July 2017</a></li>
        </ul>
        <h2>How was made this document</h2>
        <ul>
        <li><a href="report.html" target="_blank">Read the full report here</a></li>
        </ul>
        <h2>Notes</h2>
        <p>Large images were first encoded with BPG at q24 filesizes. Medium is 60% of Large. Small is 60% of Medium. Tiny is 60% of Small. Everything else was matched to +/- 5% filesize.</p>
        <p>All images have been subsampled to full range Y'CbCr prior to compression.</p>
        <p>BPG, <a href="https://github.com/kripken/j2k.js" target="_blank">JPEG 2000</a>, <a href="https://github.com/saschanaz/jxrlib.js" target="_blank">JPEG XR</a>, and <a href="http://webpjs.appspot.com/" target="_blank">WebP</a> decoded in javascript when needed. Rescaling is through Lanczos2.</p>
        <p>This page is based on <a href="http://people.xiph.org/~xiphmont/demo/daala/update1-tool2b.shtml" target="_blank">Xiph.org's</a> Daala comparison page. <a href="https://github.com/xooyoozoo/yolo-octo-bugfixes" target="_blank">Originally developed by xooyoozoo</a>. A list of sources for the images can be found in <a href="http://wyohknott.github.io/image-formats-comparison/cite_images.txt" target="_blank">this text file</a>.</p>
        <p>Last updated: july 2017.</p>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            fetch("comparisonfiles.json")
            .then(response => response.json())
            .then(function (json) {
                // subset
                var subsetSel = document.getElementById("subsetSel");

                var subsetChange = function (event){
                    if(!event) {
                        value = subsetSel.value;
                    } else {
                        value = event.target.value;
                    }
                    // format
                    var leftSel = document.getElementById("leftSel");
                    var rightSel = document.getElementById("rightSel");
                    for (format of json["comparisonfiles"][value]["format"]) {
                        var optLeft = document.createElement("option");
                        var optRight = document.createElement("option");
                        optLeft.folder = format["name"];
                        optLeft.text = format["name"];
                        optLeft.value = format["extension"];
                        leftSel.add(optLeft, null);
                        optRight.folder = format["name"];
                        optRight.text = format["name"];
                        optRight.value = format["extension"];
                        rightSel.add(optRight, null);
                    }
                    // files
                    var fileSel = document.getElementById("fileSel");
                    for (file of json["comparisonfiles"][value]["files"]) {
                        var opt = document.createElement("option");
                        opt.value = file["filename"];
                        opt.text = file["title"];
                        fileSel.add(opt, null);
                    }
                }

                subsetSel.onchange=subsetChange;

                for (subset in json['comparisonfiles']) {
                    var opt = document.createElement("option");
                    opt.value = subset;
                    opt.text = subset;
                    subsetSel.add(opt, null);
                }

                subsetChange();
            });
        });
    </script>
</body>

</html>
